<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>3</epicId>
    <storyId>3</storyId>
    <title>Quiz Assessment and Feedback</title>
    <status>drafted</status>
    <generatedAt>2025-12-09</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/3-3-quiz-assessment-and-feedback.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>a user</asA>
    <iWant>to get immediate feedback on my answers and see a final score</iWant>
    <soThat>I know how I performed</soThat>
    <tasks>
- [ ] **Task 1: Implement Answer Submission Logic (AC: 1)**
  - [ ] Subtask 1.1: Create a `POST /api/quiz/submit` endpoint in `backend/app/api/`.
  - [ ] Subtask 1.2: The endpoint should accept `quiz_id` and user answers.
  - [ ] Subtask 1.3: Implement logic to compare user answers with correct answers.
- [ ] **Task 2: Implement Immediate Feedback UI (AC: 1)**
  - [ ] Subtask 2.1: On the frontend, display immediate feedback (correct/incorrect) after each answer submission.
  - [ ] Subtask 2.2: Visually indicate correct/incorrect answers (e.g., green/red styling).
- [ ] **Task 3: Implement Final Score Display (AC: 2)**
  - [ ] Subtask 3.1: After the quiz is completed, display the user's summary score.
  - [ ] Subtask 3.2: Display motivational/demotivational feedback based on the score (as per UX design).
- [ ] **Task 4: Write Tests (AC: 1, 2)**
  - [ ] Subtask 4.1: Write unit tests for the backend assessment logic.
  - [ ] Subtask 4.2: Write integration tests for the `POST /api/quiz/submit` endpoint.
  - [ ] Subtask 4.3: Write UI tests for immediate feedback and final score display.
    </tasks>
  </story>

  <acceptanceCriteria>
1.  Given I answer a question, when I submit my answer, then I am immediately shown if it was correct or incorrect.
2.  Given I complete the quiz, when it is over, then a summary score (e.g., "You got 8/10 correct") is displayed.
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>QuizZum UX Design Specification</title>
        <section>User Journey: Take Adaptive Quizzes</section>
        <snippet>User sees: After all questions have been answered, a "Submit Quiz" button becomes active.
User does: Clicks "Submit Quiz."
System responds: The system instantly processes the answers and displays comprehensive results. Incorrect answers are clearly marked red, correct answers green. The user's score (e.g., "You scored 8/10!") is presented alongside the dynamically chosen motivational or humoristic demotivational feedback message.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-3.md</path>
        <title>Epic Technical Specification: Adaptive Quizzing</title>
        <section>Detailed Design</section>
        <snippet>| Service/Module | Responsibility | Inputs | Outputs | Owner |
| --- | --- | --- | --- | --- |
| `QuizService` | Orchestrates quiz generation, assessment, and adaptation logic. | Content, difficulty, user answers | Quiz questions, feedback, adaptive quiz parameters | Backend Team |
| `QuizUI` | React component for displaying quizzes, handling user interaction, and showing results. | Quiz questions, user input, feedback | User answers, quiz requests | Frontend Team |</snippet>
      </doc>
      <doc>
        <path>docs/epics-QuizZum-2025-12-05.md</path>
        <title>QuizZum - Epic Breakdown</title>
        <section>Story 3.3: (MVP) Quiz Assessment and Feedback</section>
        <snippet>User Story: As a user, I want to get immediate feedback on my answers and see a final score, so that I know how I performed.</snippet>
      </doc>
    </docs>
    <code>
      <file>
        <path>backend/app/core/quiz_service.py</path>
        <action>Modify</action>
        <reason>Add logic for assessing quiz answers.</reason>
      </file>
      <file>
        <path>backend/app/api/quiz.py</path>
        <action>Modify</action>
        <reason>Add endpoint for submitting quiz answers (`POST /api/quiz/submit`).</reason>
      </file>
      <file>
        <path>frontend/src/app/quiz/page.tsx</path>
        <action>Modify</action>
        <reason>Implement UI for immediate feedback and final score display.</reason>
      </file>
    </code>
    <dependencies>{{dependencies_artifacts}}</dependencies>
  </artifacts>

  <constraints>
      <constraint>The backend is a FastAPI application.</constraint>
      <constraint>The frontend is a Next.js application using Chakra UI.</constraint>
      <constraint>Immediate feedback (correct/incorrect) must be provided to the user.</constraint>
      <constraint>A summary score must be displayed upon quiz completion.</constraint>
      <constraint>Motivational/demotivational feedback should be displayed based on UX design.</constraint>
    </constraints>
  <interfaces>
      <interface>
        <name>Quiz Submission API</name>
        <kind>REST endpoint</kind>
        <signature>POST /api/quiz/submit</signature>
        <path>backend/app/api/quiz.py</path>
      </interface>
    </interfaces>
  <tests>
      <standards>
        A layered testing approach will be adopted: Unit, Integration, E2E. Unit tests for backend logic, integration tests for API endpoints, and UI tests for frontend feedback.
      </standards>
      <locations>
        - Backend: `backend/app/tests/test_quiz.py` (modification)
        - Frontend: `frontend/src/app/quiz/page.test.tsx` (modification)
      </locations>
      <ideas>
        - Write unit tests for the backend assessment logic to ensure correct scoring.
        - Write integration tests for the `POST /api/quiz/submit` endpoint to verify data flow and responses.
        - Write UI tests to verify that immediate correct/incorrect feedback is displayed.
        - Write UI tests to verify that the final score and motivational/demotivational feedback are displayed upon quiz completion.
      </ideas>
    </tests>
</story-context>
